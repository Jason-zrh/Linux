<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>To 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@100;300&family=Montserrat:wght@100;300&display=swap" rel="stylesheet">
    
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000105; overflow: hidden; font-family: 'PingFang SC', sans-serif; -webkit-tap-highlight-color: transparent; }
        canvas { position: absolute; inset: 0; touch-action: none; width: 100%; height: 100%; }

        .overlay {
            position: absolute; inset: 0;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 100; color: #fff; text-align: center;
        }

        #start-screen { z-index: 200; background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(10px); transition: opacity 1.5s; }
        #countdown-ui { opacity: 0; display: none; pointer-events: none; transition: opacity 1.5s; }

        #timer { 
            font-family: 'JetBrains Mono', monospace; 
            font-size: 5.5rem; letter-spacing: -2px; font-weight: 100; 
            text-shadow: 0 0 20px rgba(165, 202, 255, 0.5), 0 0 40px rgba(165, 202, 255, 0.3); 
            margin: 15px 0; font-variant-numeric: tabular-nums;
        }

        .label { font-family: 'Montserrat', sans-serif; opacity: 0.5; letter-spacing: 6px; font-size: 0.8rem; text-transform: uppercase; }
        #romance-box { display: none; opacity: 0; flex-direction: column; align-items: center; transition: 2s; }
        
        .secret-btn {
            pointer-events: auto; padding: 18px 50px; border-radius: 50px; background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.4); color: #fff; letter-spacing: 5px; cursor: pointer;
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); transition: 0.4s;
            font-family: 'Montserrat', sans-serif;
        }

        #wish-card {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.5);
            width: 85%; max-width: 460px; height: 380px;
            background: linear-gradient(135deg, rgba(255,255,255,0.12), rgba(255,255,255,0.03));
            border: 1px solid rgba(255,255,255,0.25); border-radius: 40px;
            padding: 40px 25px; backdrop-filter: blur(45px); -webkit-backdrop-filter: blur(45px);
            opacity: 0; pointer-events: none; z-index: 300;
            box-shadow: 0 40px 100px rgba(0,0,0,0.8);
            display: flex; flex-direction: column; justify-content: space-between; align-items: center;
            transition: all 2.5s cubic-bezier(0.19, 1, 0.22, 1);
        }
        #wish-card.show { opacity: 1; transform: translate(-50%, -50%) scale(1); pointer-events: auto; }
        
        .card-header { width: 100%; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 20px; }
        .card-title { font-size: 0.85rem; color: rgba(255,255,255,0.9); letter-spacing: 8px; font-weight: 300; }
        .card-content-wrap { flex-grow: 1; display: flex; align-items: center; justify-content: center; width: 100%; }
        .card-content { 
            font-size: 1.5rem; font-weight: 300; line-height: 1.8; letter-spacing: 2px;
            text-align: center;
            background: linear-gradient(90deg, #fff, #a5caff, #fff);
            background-size: 200% auto; -webkit-background-clip: text; background-clip: text;
            -webkit-text-fill-color: transparent; animation: flow 5s infinite;
        }
        @keyframes flow { to { background-position: 200% center; } }
        .card-footer { width: 100%; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; }
        .footer-note { font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: rgba(165, 202, 255, 0.5); letter-spacing: 12px; }
        .click-hint { position: absolute; bottom: 20px; color: rgba(255,255,255,0.2); font-size: 0.65rem; letter-spacing: 3px; font-family: 'Montserrat', sans-serif;}

        #finale-message {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 2rem; font-weight: 300; color: #fff; letter-spacing: 4px; line-height: 1.6;
            text-shadow: 0 0 15px rgba(255,255,255,0.8);
            opacity: 0; transition: opacity 2s; pointer-events: none; z-index: 400; display: none; text-align: center;
        }
        #finale-message.show { opacity: 1; display: block; }

        @media (max-width: 600px) { 
            #timer { font-size: 3.5rem; letter-spacing: -1px; } 
            .card-content { font-size: 1.2rem; } 
            #wish-card { height: 350px; width: 90%; }
            #finale-message { font-size: 1.5rem; }
        }
    </style>
</head>
<body>

<audio id="bgm" loop><source src="music.mp3" type="audio/mpeg"></audio>

<canvas id="nebula"></canvas>
<canvas id="aurora"></canvas>
<canvas id="stars"></canvas>
<canvas id="meteors"></canvas>
<canvas id="fireworks"></canvas>
<canvas id="ripples"></canvas>

<div id="start-screen" class="overlay">
    <button class="secret-btn" onclick="startApp()">点击开始跨年倒计时</button>
</div>

<div id="countdown-ui" class="overlay">
    <div id="countdown-box">
        <div class="label">Count down to 2026</div>
        <div id="timer">00:00:00</div>
        <div class="label">愿年年岁岁，并肩看星河</div>
    </div>
    <div id="romance-box">
        <button class="secret-btn" onclick="reveal()">致2026年的我们</button>
    </div>
</div>

<div id="wish-card">
    <div class="card-header">
        <div class="card-title">—— 遇见即是上上签 ——</div>
    </div>
    <div class="card-content-wrap">
        <div id="wish-text" class="card-content"></div>
    </div>
    <div class="card-footer">
        <div id="dynamic-word" class="footer-note">DREAM</div>
    </div>
    <div class="click-hint">CLICK TO CONTINUE</div>
</div>

<div id="finale-message">
    <p>请你看2026的第一场烟花!</p>
</div>

<script>
const dpr = window.devicePixelRatio || 1;
const w = window.innerWidth, h = window.innerHeight;
const canvNames = ["nebula", "aurora", "stars", "meteors", "fireworks", "ripples"];
const ctx = {};
canvNames.forEach(n => {
    const c = document.getElementById(n);
    c.width = w * dpr; c.height = h * dpr;
    ctx[n] = c.getContext("2d"); ctx[n].scale(dpr, dpr);
});

// 设置目标时间
const targetTime = new Date("2026/01/01 00:00:00").getTime();
const quoteStages = [
    "现在的我们, 正是还没想好去哪里, 也可以先跑起来的年纪.不要听外界的声音,而是要听从你内心的节奏.",
    "歌里唱着‘遇见’, 但我更想祝你遇见那个——不被定义、不被干扰、全然相信自己的你.",
    "哪怕这个世界偶尔嘈杂,也希望你永远有做自己的底气. 你不需要变得完美, 你只需要做最好的自己.",
    "2026年, 愿你不再为了别人的期待而左右摇摆. 去感受风, 去追逐光, 去活成你自己最喜欢的样子.",
    "万物更新, 旧疾当愈. 祝你新的一年: 有趣、有盼. 我们都要在自己的航道里,活得热烈且自由!"
];
let currentStage = 0, isTyping = false, mode = "start_wait", speedUp = 1;
const words = ["ALWAYS", "BETTER", "SHINE", "BESTIE", "WISER"];
let footerCycleInterval = null;

// --- 拟真物理烟花粒子类 ---
class Particle {
    constructor(x, y, hue) {
        this.x = x; this.y = y;
        this.hue = hue;
        this.friction = 0.96;
        this.gravity = 0.15;
        this.alpha = 1;
        this.decay = Math.random() * 0.01 + 0.008;
        this.speed = Math.random() * 10 + 2;
        this.angle = Math.random() * Math.PI * 2;
        this.vx = Math.cos(this.angle) * this.speed;
        this.vy = Math.sin(this.angle) * this.speed;
        this.history = [];
    }
    update() {
        this.vx *= this.friction;
        this.vy *= this.friction;
        this.vy += this.gravity;
        this.x += this.vx;
        this.y += this.vy;
        this.alpha -= this.decay;
        this.history.push({x: this.x, y: this.y});
        if(this.history.length > 6) this.history.shift();
    }
    draw(c) {
        c.save();
        c.globalCompositeOperation = 'lighter';
        c.beginPath();
        if(this.history.length > 0) {
            c.moveTo(this.history[0].x, this.history[0].y);
            for(let p of this.history) c.lineTo(p.x, p.y);
        }
        c.strokeStyle = `hsla(${this.hue}, 100%, 70%, ${this.alpha})`;
        c.lineWidth = 1.8;
        c.stroke();
        c.fillStyle = `hsla(${this.hue}, 100%, 90%, ${this.alpha})`;
        c.beginPath(); c.arc(this.x, this.y, 1.2, 0, Math.PI*2); c.fill();
        c.restore();
    }
}

let fireworkParticles = [];
function createFirework(x, y) {
    const hue = Math.random() * 360;
    const count = 250; 
    for(let i=0; i<count; i++) fireworkParticles.push(new Particle(x, y, hue));
}

function drawNebula() {
    ctx.nebula.clearRect(0,0,w,h);
    let grd = ctx.nebula.createRadialGradient(w/2, h/2, 0, w/2, h/2, w);
    grd.addColorStop(0, "#000818"); grd.addColorStop(1, "#000");
    ctx.nebula.fillStyle = grd; ctx.nebula.fillRect(0,0,w,h);
}

let auroraTime = 0;
function drawAurora() {
    ctx.aurora.clearRect(0,0,w,h); auroraTime += 0.003;
    ctx.aurora.globalCompositeOperation = "screen";
    const layers = [{ c: "rgba(0, 255, 180, 0.15)", f: 0.0008, a: 90, y: h*0.3 }, { c: "rgba(180, 50, 255, 0.1)", f: 0.0006, a: 110, y: h*0.25 }];
    layers.forEach(l => {
        ctx.aurora.save(); ctx.aurora.beginPath();
        for(let x=0; x<=w; x+=20) ctx.aurora.lineTo(x, l.y + Math.sin(x*l.f + auroraTime) * l.a);
        ctx.aurora.strokeStyle = l.c; ctx.aurora.lineWidth = 200; ctx.aurora.filter = 'blur(60px)';
        ctx.aurora.stroke(); ctx.aurora.restore();
    });
}

let starPoints = Array.from({length: 100}, () => ({ 
    x: Math.random()*w, y: Math.random()*h, r: Math.random()*1.2, 
    vx: (Math.random()-.5)*0.3, vy: (Math.random()-.5)*0.3, phase: Math.random()*Math.PI 
}));

function drawStars() {
    ctx.stars.clearRect(0, 0, w, h);
    starPoints.forEach(p => {
        p.x = (p.x + p.vx * speedUp + w) % w;
        p.y = (p.y + p.vy * speedUp + h) % h;
        const alpha = 0.3 + Math.abs(Math.sin(p.phase += 0.01)) * 0.7;
        ctx.stars.fillStyle = `rgba(255,255,255,${alpha})`;
        ctx.stars.beginPath(); ctx.stars.arc(p.x, p.y, p.r, 0, Math.PI * 2); ctx.stars.fill();
    });
    ctx.stars.lineWidth = 0.5;
    for (let i = 0; i < starPoints.length; i++) {
        for (let j = i + 1; j < starPoints.length; j++) {
            const p1 = starPoints[i]; const p2 = starPoints[j];
            const dist = Math.sqrt((p1.x - p2.x) ** 2 + (p1.y - p2.y) ** 2);
            if (dist < 90) {
                ctx.stars.strokeStyle = `rgba(165, 202, 255, ${(1 - dist/90)*0.15})`;
                ctx.stars.beginPath(); ctx.stars.moveTo(p1.x, p1.y); ctx.stars.lineTo(p2.x, p2.y); ctx.stars.stroke();
            }
        }
    }
}

let meteorList = [];
class Meteor {
    constructor() { this.init(); this.shards = []; }
    init() { this.x = Math.random()*w*1.5; this.y = Math.random()*-300; this.vx = -6; this.vy = 6; this.alpha = 1; }
    draw() {
        ctx.meteors.save();
        let grad = ctx.meteors.createLinearGradient(this.x, this.y, this.x+30, this.y-30);
        grad.addColorStop(0, `rgba(255,255,255,${this.alpha})`); grad.addColorStop(1, "transparent");
        ctx.meteors.strokeStyle = grad; ctx.meteors.lineWidth = 2;
        ctx.meteors.beginPath(); ctx.meteors.moveTo(this.x, this.y); ctx.meteors.lineTo(this.x+60, this.y-60); ctx.meteors.stroke();
        ctx.meteors.restore();
        if(Math.random() > 0.4) this.shards.push({ x: this.x, y: this.y, vx: (Math.random()-.5)*2, vy: (Math.random()-.5)*2, a: 1 });
        this.shards.forEach((s, i) => {
            s.x += s.vx; s.y += s.vy; s.a -= 0.02;
            if(s.a <= 0) this.shards.splice(i, 1);
            ctx.meteors.fillStyle = `rgba(255,255,255,${s.a})`;
            ctx.meteors.beginPath(); ctx.meteors.arc(s.x, s.y, 0.8, 0, Math.PI*2); ctx.meteors.fill();
        });
        this.x += this.vx*speedUp; this.y += this.vy*speedUp; this.alpha -= 0.01*speedUp;
        if(this.alpha <= 0) this.init();
    }
}
for(let i=0; i<6; i++) meteorList.push(new Meteor());

let ripples = [];
function startApp() {
    document.getElementById('bgm').play().catch(() => {});
    document.getElementById('start-screen').style.opacity = '0';
    setTimeout(() => {
        document.getElementById('start-screen').style.display = 'none';
        const ui = document.getElementById('countdown-ui');
        ui.style.display = 'flex';
        setTimeout(() => { ui.style.opacity = '1'; mode = "countdown"; }, 50);
    }, 1500);
}

function reveal() {
    document.getElementById("romance-box").style.opacity = 0; speedUp = 8;
    setTimeout(() => { 
        document.getElementById("romance-box").style.display = "none"; 
        document.getElementById("wish-card").classList.add("show"); 
        mode = "reading"; speedUp = 1; typeQuote(); startFooterCycle(); 
    }, 1200);
}

function typeQuote() {
    isTyping = true; const textEl = document.getElementById("wish-text"); const fullText = quoteStages[currentStage];
    textEl.innerHTML = ""; let i = 0;
    const t = setInterval(() => {
        if(i < fullText.length) { textEl.innerHTML = fullText.substring(0, i+1) + "<span style='opacity:0.6'>|</span>"; i++; }
        else { textEl.innerHTML = fullText; clearInterval(t); isTyping = false; }
    }, 100);
}

function startFooterCycle() { 
    footerCycleInterval = setInterval(() => { 
        const dw = document.getElementById("dynamic-word"); dw.style.opacity = 0; 
        setTimeout(() => { dw.innerText = words[Math.floor(Math.random()*words.length)]; dw.style.opacity = 0.4; }, 800); 
    }, 4000); 
}

function handleGlobalClick(x, y) {
    if(mode === "reading") {
        ripples.push({ x, y, r: 0, a: 0.6 }); 
        if(!isTyping) { 
            if(currentStage < quoteStages.length - 1) { currentStage++; typeQuote(); }
            else { 
                mode = "finale";
                document.getElementById("wish-card").style.opacity = 0;
                setTimeout(() => {
                    document.getElementById("wish-card").style.display = "none";
                    const finaleMsg = document.getElementById("finale-message");
                    finaleMsg.classList.add("show");
                    
                    // 文字显示 4 秒后开始淡出
                    setTimeout(() => {
                        finaleMsg.style.opacity = "0";
                        // 彻底隐藏元素
                        setTimeout(() => { finaleMsg.style.display = "none"; }, 2000);
                    }, 2000);

                    clearInterval(footerCycleInterval);
                    setInterval(() => createFirework(Math.random()*w, Math.random()*h*0.65), 200);
                }, 1000);
            } 
        } 
    }
    if(mode !== "start_wait") createFirework(x, y);
}

function loop() {
    drawNebula(); drawAurora(); drawStars();
    ctx.meteors.clearRect(0,0,w,h); meteorList.forEach(m => m.draw());
    
    ctx.fireworks.clearRect(0,0,w,h);
    fireworkParticles.forEach((p, i) => {
        p.update(); p.draw(ctx.fireworks);
        if(p.alpha <= 0) fireworkParticles.splice(i, 1);
    });

    ctx.ripples.clearRect(0,0,w,h);
    ripples.forEach((r, i) => {
        r.r += 3; r.a -= 0.015; if(r.a <= 0) ripples.splice(i, 1);
        ctx.ripples.strokeStyle = `rgba(255,255,255,${r.a})`;
        ctx.ripples.beginPath(); ctx.ripples.arc(r.x, r.y, r.r, 0, Math.PI*2); ctx.ripples.stroke();
    });

    if(mode !== "start_wait") {
        const diff = targetTime - Date.now();
        if(diff > 0) {
            const hh = String(Math.floor(diff/3600000)).padStart(2,'0'), mm = String(Math.floor((diff%3600000)/60000)).padStart(2,'0'), ss = String(Math.floor((diff%60000)/1000)).padStart(2,'0');
            document.getElementById("timer").innerText = `${hh}:${mm}:${ss}`;
        } else if(mode === "countdown") {
            mode = "ready";
            document.getElementById("countdown-box").style.opacity = 0;
            setTimeout(() => {
                document.getElementById("countdown-box").style.display = "none";
                document.getElementById("romance-box").style.display = "flex";
                setTimeout(() => document.getElementById("romance-box").style.opacity = 1, 50);
            }, 1000);
        }
    }
    requestAnimationFrame(loop);
}

window.addEventListener("mousedown", e => handleGlobalClick(e.clientX, e.clientY));
window.addEventListener("touchstart", e => {
    handleGlobalClick(e.touches[0].clientX, e.touches[0].clientY);
}, { passive: true });

loop();
</script>
</body>
</html>