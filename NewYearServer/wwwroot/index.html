<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 新春快乐</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@100;300&family=Noto+Sans+SC:wght@300;500&family=Montserrat:wght@100;300&display=swap" rel="stylesheet">
    
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000105; overflow: hidden; font-family: 'Noto Sans SC', sans-serif; -webkit-tap-highlight-color: transparent; }
        canvas { position: absolute; inset: 0; touch-action: none; width: 100%; height: 100%; }

        .overlay {
            position: absolute; inset: 0;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 100; color: #fff; text-align: center; pointer-events: none;
        }

        /* 倒计时：数字等宽，防止跳动 */
        #timer { 
            font-family: 'JetBrains Mono', monospace; 
            font-size: 5.5rem; 
            letter-spacing: -2px;
            font-weight: 100; 
            text-shadow: 0 0 20px rgba(165, 202, 255, 0.5), 0 0 40px rgba(165, 202, 255, 0.3); 
            margin: 15px 0;
            font-variant-numeric: tabular-nums;
        }

        .label { 
            font-family: 'Montserrat', sans-serif;
            opacity: 0.6; 
            letter-spacing: 6px; 
            font-size: 0.85rem; 
            text-transform: uppercase;
        }

        #romance-box { display: none; opacity: 0; flex-direction: column; align-items: center; transition: 2s; }
        
        .secret-btn {
            pointer-events: auto; padding: 18px 50px; border-radius: 50px; background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.4); color: #fff; letter-spacing: 5px; cursor: pointer;
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); transition: 0.4s;
            font-family: 'Noto Sans SC', sans-serif; font-weight: 300;
        }

        /* 卡片设计 */
        #wish-card {
            position: fixed; top: 50%; left: 50%; 
            transform: translate(-50%, -50%) scale(0.5);
            width: 85%; max-width: 480px; height: 400px;
            background: linear-gradient(135deg, rgba(255,255,255,0.12), rgba(255,255,255,0.03));
            border: 1px solid rgba(255,255,255,0.25); border-radius: 40px;
            padding: 40px 30px; backdrop-filter: blur(45px); -webkit-backdrop-filter: blur(45px);
            opacity: 0; pointer-events: none; z-index: 200;
            box-shadow: 0 40px 100px rgba(0,0,0,0.8);
            display: flex; flex-direction: column; justify-content: space-between; align-items: center;
            transition: all 2.5s cubic-bezier(0.19, 1, 0.22, 1);
        }
        #wish-card.show { opacity: 1; transform: translate(-50%, -50%) scale(1); pointer-events: auto; }
        
        .card-header { width: 100%; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 20px; }
        .card-title { font-size: 0.9rem; color: rgba(255,255,255,0.9); letter-spacing: 8px; font-weight: 300; }

        .card-content-wrap { flex-grow: 1; display: flex; align-items: center; justify-content: center; padding: 20px 0; width: 100%; }
        
        /* 关键修改：添加 text-align: center 确保多行文本居中 */
        .card-content { 
            font-size: 1.45rem; font-weight: 500; line-height: 1.8; letter-spacing: 1px;
            text-align: center; /* 确保第二行及后续行居中 */
            word-break: break-all;
            background: linear-gradient(90deg, #fff, #a5caff, #fff); 
            background-size: 200% auto; -webkit-background-clip: text; background-clip: text;
            -webkit-text-fill-color: transparent; animation: flow 5s infinite;
        }
        @keyframes flow { to { background-position: 200% center; } }

        .card-footer { width: 100%; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; }
        .footer-note { font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: rgba(165, 202, 255, 0.5); letter-spacing: 12px; }

        .click-hint { position: absolute; bottom: 20px; color: rgba(255,255,255,0.2); font-size: 0.65rem; letter-spacing: 3px; font-family: 'Montserrat', sans-serif;}

        @media (max-width: 600px) { 
            #timer { font-size: 3.5rem; letter-spacing: -1px; } 
            .card-content { font-size: 1.25rem; } 
            #wish-card { height: 380px; width: 90%; padding: 30px 20px; } 
        }
    </style>
</head>
<body>

<audio id="bgm" loop>
    <source src="music.mp3" type="audio/mpeg">
</audio>

<canvas id="nebula"></canvas>
<canvas id="aurora"></canvas>
<canvas id="stars"></canvas>
<canvas id="meteors"></canvas>
<canvas id="fireworks"></canvas>
<canvas id="ripples"></canvas>

<div class="overlay">
    <div id="countdown-box">
        <div class="label">Countdown to 2026</div>
        <div id="timer">00:00:00</div>
        <div class="label">岁末将至，顺问冬安</div>
    </div>
    <div id="romance-box">
        <button class="secret-btn" onclick="reveal()">轻点前往 -> 2026 </button>
    </div>
</div>

<div id="wish-card">
    <div class="card-header">
        <div class="card-title">—— 2026 上上签 ——</div>
    </div>
    <div class="card-content-wrap">
        <div id="wish-text" class="card-content"></div>
    </div>
    <div class="card-footer">
        <div id="dynamic-word" class="footer-note">BLESS</div>
    </div>
    <div class="click-hint">轻点屏幕以继续</div>
</div>

<script>
// 基础环境配置
const dpr = window.devicePixelRatio || 1;
const w = window.innerWidth, h = window.innerHeight;
const canvNames = ["nebula", "aurora", "stars", "meteors", "fireworks", "ripples"];
const ctx = {};
canvNames.forEach(n => {
    const c = document.getElementById(n);
    c.width = w * dpr; c.height = h * dpr;
    ctx[n] = c.getContext("2d"); ctx[n].scale(dpr, dpr);
});

const targetTime = new Date("2026/1/1 00:00:00").getTime();

// --- 平辈/好友高级版祝福语 ---
const quoteStages = [
    "2026,愿你保持热爱,奔赴山海。在自己的世界里，活成最闪耀的星辰。",
    "万物更新，旧疾当愈。祝你在新的一年里，有能力爱自己，也有余力爱世界。",
    "前路浩浩荡荡，万物尽可期待。愿我们在这个时代里，既有独立清醒的灵魂，也有滚烫的理想。",
    "生活虽有琐碎,但星光从不缺席。2026,愿你所得皆所愿,所行皆坦途,活出不被定义的精彩。",
    "岁且更始，时乃日新。祝你：有趣、有盼、无灾、无难。我们顶峰相见。"
];

let currentStage = 0, isTyping = false;
const words = ["PEACE", "HOPE", "LUCK", "DREAM", "WISH"];
let mode = "countdown", mouse = { x: -1000, y: -1000 }, speedUp = 1;

// 动画逻辑 (略...)
function drawNebula() {
    ctx.nebula.clearRect(0,0,w,h);
    let grd = ctx.nebula.createRadialGradient(w/2, h/2, 0, w/2, h/2, w);
    grd.addColorStop(0, "#000818"); grd.addColorStop(1, "#000");
    ctx.nebula.fillStyle = grd; ctx.nebula.fillRect(0,0,w,h);
}

let auroraTime = 0;
function drawAurora() {
    ctx.aurora.clearRect(0,0,w,h);
    auroraTime += 0.003;
    ctx.aurora.globalCompositeOperation = "screen";
    const isMobile = w < 600;
    const layers = [
        { c: "rgba(0, 255, 180, 0.12)", f: 0.0008, a: isMobile ? 60 : 90, y: h*0.3 },
        { c: "rgba(165, 202, 255, 0.08)", f: 0.0006, a: isMobile ? 80 : 110, y: h*0.25 }
    ];
    layers.forEach(l => {
        ctx.aurora.save(); ctx.aurora.beginPath();
        for(let x=0; x<=w; x+=(isMobile?10:20)) {
            let sinY = Math.sin(x*l.f + auroraTime) * l.a;
            ctx.aurora.lineTo(x, l.y + sinY);
        }
        ctx.aurora.strokeStyle = l.c; ctx.aurora.lineWidth = isMobile ? 100 : 200;
        ctx.aurora.filter = `blur(${isMobile?30:60}px)`; ctx.aurora.stroke(); ctx.aurora.restore();
    });
}

let starPoints = Array.from({length: 120}, () => ({
    x: Math.random()*w, y: Math.random()*h, r: Math.random()*1.5,
    vx: (Math.random()-.5)*0.3, vy: (Math.random()-.5)*0.3, phase: Math.random()*Math.PI
}));
function drawStars() {
    ctx.stars.clearRect(0,0,w,h);
    starPoints.forEach(p => {
        p.x = (p.x + p.vx * speedUp + w) % w; p.y = (p.y + p.vy * speedUp + h) % h;
        let brightness = 0.3 + Math.abs(Math.sin(p.phase += 0.01)) * 0.7;
        ctx.stars.fillStyle = `rgba(255,255,255,${brightness})`;
        ctx.stars.beginPath(); ctx.stars.arc(p.x, p.y, p.r, 0, Math.PI*2); ctx.stars.fill();
    });
}

let meteorList = [];
class Meteor {
    constructor() { this.init(); }
    init() { this.x = Math.random()*w*1.5; this.y = Math.random()*-300; this.vx = -6; this.vy = 6; this.alpha = 1; }
    draw() {
        ctx.meteors.save();
        let grad = ctx.meteors.createLinearGradient(this.x, this.y, this.x+30, this.y-30);
        grad.addColorStop(0, `rgba(255,255,255,${this.alpha})`); grad.addColorStop(1, "transparent");
        ctx.meteors.strokeStyle = grad; ctx.meteors.lineWidth = 2;
        ctx.meteors.beginPath(); ctx.meteors.moveTo(this.x, this.y); ctx.meteors.lineTo(this.x+60, this.y-60); ctx.meteors.stroke();
        ctx.meteors.restore();
        this.x += this.vx*speedUp; this.y += this.vy*speedUp; this.alpha -= 0.01*speedUp;
        if(this.alpha <= 0) this.init();
    }
}
for(let i=0; i<6; i++) meteorList.push(new Meteor());

let particles = [];
function createFirework(x, y) {
    let h_val = Math.random()*360;
    for(let i=0; i<60; i++) {
        let ang = Math.random()*Math.PI*2, sp = Math.random()*5+2;
        particles.push({x, y, vx:Math.cos(ang)*sp, vy:Math.sin(ang)*sp, a:1, h:h_val});
    }
}

let ripples = [];
function createRipple(x, y) { ripples.push({ x, y, r: 0, a: 0.6 }); }

function loop() {
    drawNebula(); drawAurora(); drawStars();
    ctx.meteors.clearRect(0,0,w,h); meteorList.forEach(m => m.draw());
    ctx.fireworks.clearRect(0,0,w,h);
    particles.forEach((p, i) => {
        p.x+=p.vx; p.y+=p.vy; p.vy+=0.08; p.a-=0.015;
        if(p.a<=0) particles.splice(i,1);
        ctx.fireworks.fillStyle=`hsla(${p.h},80%,70%,${p.a})`;
        ctx.fireworks.beginPath(); ctx.fireworks.arc(p.x,p.y,1.5,0,Math.PI*2); ctx.fireworks.fill();
    });
    ctx.ripples.clearRect(0,0,w,h);
    ripples.forEach((r, i) => {
        r.r += 3; r.a -= 0.015;
        if(r.a <= 0) ripples.splice(i, 1);
        ctx.ripples.strokeStyle = `rgba(165,202,255,${r.a})`;
        ctx.ripples.beginPath(); ctx.ripples.arc(r.x, r.y, r.r, 0, Math.PI*2); ctx.ripples.stroke();
    });

    const now = Date.now(), diff = targetTime - now;
    const timerEl = document.getElementById("timer");
    if(diff > 0) {
        const hh = String(Math.floor(diff/3600000)).padStart(2,'0'), mm = String(Math.floor((diff%3600000)/60000)).padStart(2,'0'), ss = String(Math.floor((diff%60000)/1000)).padStart(2,'0');
        timerEl.innerText = `${hh}:${mm}:${ss}`;
    } else if(mode === "countdown") {
        mode = "romance";
        document.getElementById("countdown-box").style.opacity = 0;
        setTimeout(() => {
            document.getElementById("countdown-box").style.display = "none";
            let rb = document.getElementById("romance-box");
            rb.style.display = "flex"; setTimeout(() => rb.style.opacity = 1, 50);
        }, 1500);
    }
    requestAnimationFrame(loop);
}

function reveal() {
    const bgm = document.getElementById('bgm');
    bgm.play().catch(() => {});
    document.getElementById("romance-box").style.opacity = 0;
    speedUp = 8;
    setTimeout(() => {
        document.getElementById("romance-box").style.display = "none";
        document.getElementById("wish-card").classList.add("show");
        mode = "reading"; speedUp = 1; typeQuote(); startFooterCycle();
    }, 1200);
}

function nextQuote() {
    if(isTyping) return;
    if(currentStage < quoteStages.length - 1) { currentStage++; typeQuote(); }
    else { createFirework(w/2, h/2); }
}

function typeQuote() {
    isTyping = true;
    const textEl = document.getElementById("wish-text");
    const fullText = quoteStages[currentStage];
    textEl.innerHTML = "";
    let i = 0;
    const timer = setInterval(() => {
        if(i < fullText.length) {
            textEl.innerHTML = fullText.substring(0, i+1) + "<span style='opacity:0.6'>|</span>";
            i++;
        } else {
            textEl.innerHTML = fullText; clearInterval(timer); isTyping = false;
        }
    }, 70);
}

function startFooterCycle() {
    setInterval(() => {
        const dw = document.getElementById("dynamic-word");
        dw.style.opacity = 0;
        setTimeout(() => {
            dw.innerText = words[Math.floor(Math.random()*words.length)];
            dw.style.opacity = 0.4;
        }, 800);
    }, 4000);
}

const handleInput = (x, y) => { mouse.x = x; mouse.y = y; };
window.addEventListener("mousemove", e => handleInput(e.clientX, e.clientY));
window.addEventListener("touchmove", e => { handleInput(e.touches[0].clientX, e.touches[0].clientY); e.preventDefault(); }, {passive: false});
window.addEventListener("mousedown", e => { 
    if(mode === "reading") { createRipple(e.clientX, e.clientY); nextQuote(); }
    if(mode === "romance") createFirework(e.clientX, e.clientY);
});
window.addEventListener("touchstart", e => { 
    if(mode === "reading") { createRipple(e.touches[0].clientX, e.touches[0].clientY); nextQuote(); }
});

loop();
</script>
</body>
</html>